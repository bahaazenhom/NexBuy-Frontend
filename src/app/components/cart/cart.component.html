<div class="cart-container">
  <h1>Shopping Cart</h1>

  @if (loading) {
    <div class="loading">
      <div class="spinner"></div>
      <p>Loading cart...</p>
    </div>
  }

  @if (!loading) {
    @if (cart.length === 0) {
      <div class="empty-cart">
        <div class="empty-icon">ðŸ›’</div>
        <h2>Your cart is empty</h2>
        <p>Add some products to get started!</p>
        <button class="btn btn-primary" (click)="continueShopping()">
          Continue Shopping
        </button>
      </div>
    } @else {
      <div class="cart-content">
        <div class="cart-items">
          @for (item of cart; track $index) {
            <div class="cart-item">
              <div class="item-image">
                @if (typeof item.product !== 'string' && item.product.images && item.product.images.length > 0) {
                  <img [src]="item.product.images[0].url" [alt]="item.product.title" />
                } @else {
                  <div class="no-image">No Image</div>
                }
              </div>

              <div class="item-details">
                @if (typeof item.product !== 'string') {
                  <h3>{{ item.product.title }}</h3>
                  <p class="item-description">{{ item.product.desc }}</p>
                  
                  <div class="quantity-controls">
                    <button 
                      class="btn btn-quantity" 
                      (click)="decreaseQuantity(item.product._id)"
                    >
                      âˆ’
                    </button>
                    <span class="quantity-display">{{ item.quantity }}</span>
                    <button 
                      class="btn btn-quantity" 
                      (click)="increaseQuantity(item.product._id)"
                    >
                      +
                    </button>
                  </div>
                }
              </div>

              <div class="item-actions">
                @if (typeof item.product !== 'string') {
                  <div class="item-price">${{ (item.product.price * item.quantity).toFixed(2) }}</div>
                  <button class="btn btn-remove" (click)="removeFromCart(item.product._id)">
                    Remove
                  </button>
                }
              </div>
            </div>
          }
        </div>

        <div class="cart-summary">
          <h2>Order Summary</h2>
          
          <div class="summary-row">
            <span>Items ({{ cart.length }})</span>
            <span>${{ getTotal().toFixed(2) }}</span>
          </div>

          <div class="summary-row">
            <span>Shipping</span>
            <span>FREE</span>
          </div>

          <div class="summary-divider"></div>

          <div class="summary-row total">
            <span>Total</span>
            <span>${{ getTotal().toFixed(2) }}</span>
          </div>

          <button class="btn btn-checkout" (click)="proceedToCheckout()">
            Proceed to Checkout
          </button>

          <button class="btn btn-continue" (click)="continueShopping()">
            Continue Shopping
          </button>
        </div>
      </div>
    }
  }
</div>
